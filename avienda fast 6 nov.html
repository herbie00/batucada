<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Batucada â€¢ Morceau (v0.5)</title>
<meta name="theme-color" content="#111" />
<link rel="stylesheet" href="song.css" />
<script>
  window.SONG_DATA_OVERRIDE = {
    slug: "Avienda Fast 6 nov",
    title: "Avienda Fast 6 nov",
    audio: "media/Avienda Fast 6 nov.mp3",
    parts: [
      { id: "p1", label: "intro", start: 0, end: 18, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p2", label: "rep rentrent", start: 18, end: 33, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p3", label: "surdo + rep + tamb", start: 33, end: 50, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p4", label: "surdo + rep + tamb + agogo", start: 49, end: 66, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p5", label: "solo agogogo, surdo 1er tps", start: 66, end: 80, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p6", label: "caisse claire revient", start: 82, end: 98, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p7", label: "grosse caisee tous les temps, plus caisse claire, plus agogo, seulement surdo et repinik", start: 98, end: 114, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p8", label: "agogo et tembourim reviennent ", start: 112, end: 129, images: ["test1.png", "test2.png", "test3.png"] },
      { id: "p9", label: "break fin", start: 129, end: 129, images: ["test1.png", "test2.png", "test3.png"] }
    ]
  };
</script>
</head>
<body id="app" data-theme="">
<header>
  <div class="bar" id="hdr">
    <a class="iconbtn" href="index.html">â† Morceaux</a>
    <div class="title" id="songTitle">Morceau</div>
    <span class="pill">v0.5</span>
    <div class="spacer"></div>
    <button id="themeBtn" class="iconbtn">ğŸŒ“ ThÃ¨me</button>
    <button id="changelogBtn" class="iconbtn">ğŸ“ Changelog</button>
  </div>
</header>

<div class="playerSticky">
  <section class="playerCard" aria-labelledby="fullTrackTitle">
    <h2 id="fullTrackTitle">Ã‰coutez le morceau en entier</h2>
    <audio id="player" controls preload="metadata">
      <source id="audioSrc" src="" />
      Votre navigateur ne supporte pas la balise audio.
    </audio>
    <div id="audioDebug" class="audioDebug"></div>
  </section>
</div>


<!--  Additional playable files / videos  -->
<section id="extras" style="max-width:980px;margin:18px auto;padding:0 16px;">
  <h3>enregistrements lives et autres</h3>
  <p class="note">lives et phrases.</p>

  <div style="display:grid;gap:10px;grid-template-columns:1fr;">
    <!-- minimal stacked player: title on first line, player on second + skip controls -->
    <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
      <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Avienda live.mp3</div>
      <div style="display:flex;gap:8px;align-items:center;">
        <audio id="extra-player-4" controls preload="metadata" style="width:100%;">
          <source src="media/Avienda live.mp3" type="audio/mp3" />
          Votre navigateur ne supporte pas la balise audio.
        </audio>
      </div>
      <div style="display:flex;gap:8px;align-items:center;">
        <button class="extra-skip" data-target="extra-player-4" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
        <button class="extra-skip" data-target="extra-player-4" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
      </div>
    </article>
  </div>
</section>


<main>
  <p class="note">
    Touchez â–¶ ou le titre dâ€™une section pour y sauter. Touchez une image pour lâ€™ouvrir en plein Ã©cran.
  </p>

  <section aria-labelledby="partsTitle">
    <h2 id="partsTitle" class="sr-only">Sections (partitions)</h2>
    <div id="sections" class="sections"></div>
  </section>
</main>

<!-- Visionneuse plein Ã©cran -->
<div id="fsOverlay" class="fsOverlay" aria-hidden="true">
  <div class="fsInner" id="fsInner">
    <button id="fsClose" class="fsClose" type="button">âœ• Fermer</button>
    <div class="fsImageWrap" id="fsImageWrap">
      <img id="fsImage" src="" alt="Partition en plein Ã©cran">
    </div>
    <div class="fsMeta">
      <div id="fsLabel" class="fsLabel"></div>
      <div id="fsTime" class="fsTime"></div>
      <div class="fsNavRow">
        <button id="fsPrev" class="fsNavBtn left" type="button"></button>
        <button id="fsNext" class="fsNavBtn right" type="button"></button>
      </div>
      <div class="fsControlsRow">
        <button id="fsPlay" class="fsPlayBtn" type="button">â–¶ Lire Ã  partir dâ€™ici</button>
        <button id="fsZoom" class="fsZoomBtn" type="button">ğŸ” Zoom</button>
      </div>
    </div>
  </div>
</div>

<section id="changelog" class="changelog">
  <h4>Changelog</h4>
  <ul class="small">
    <li><strong>v0.5</strong> - Pages morceaux en HTML statique (plus de JSON), correction de certains noms de m?dias, ajout d''une playlist vid?o YouTube et de tests pour les tableaux.</li>
    <li><strong>v0.4.4</strong> - Zoom clair (scale) avec d?filement, lecteur ? nouveau en haut (sticky), texte du lecteur masqu? en plein ?cran.</li>
    <li><strong>v0.4.3</strong> - corrections image plein ?cran & espacement.</li>
    <li><strong>v0.4.2</strong> - visionneuse plein ?cran initiale.</li>
  </ul>
</section>

<script src="song.js"></script>
</body>
</html>

<script src="song.js"></script>
<script>
  // attach -10/+10s controls for extra players
  (function(){
    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }
    document.querySelectorAll('.extra-skip').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        const targetId = btn.dataset.target;
        const offset = Number(btn.dataset.offset) || 0;
        const p = document.getElementById(targetId);
        if(!p) return;
        try{
          const cur = Number(p.currentTime) || 0;
          const dur = Number(p.duration) || Infinity;
          const next = clamp(cur + offset, 0, isFinite(dur) ? dur : cur + offset);
          p.currentTime = next;
        }catch(err){ /* ignore */ }
      });
    });
  })();
</script>
</body>
</html>

