<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Batucada ‚Ä¢ Morceau (v0.5)</title>
<meta name="theme-color" content="#111" />
<link rel="stylesheet" href="song.css" />
<style>
  .tabNav{max-width:980px;margin:12px auto 0;padding:0 16px;display:flex;gap:8px;flex-wrap:wrap}
  .tabBtn{flex:1;min-width:140px;border:1px solid var(--border,#e6e6e6);background:var(--card,#f6f7f9);color:var(--fg,#111);padding:10px 12px;border-radius:999px;font-weight:600;cursor:pointer;transition:.2s}
  .tabBtn.active{background:var(--accent,#2563eb);color:#fff;border-color:var(--accent,#2563eb)}
  .tabContent{margin:16px auto;max-width:980px;padding:0 16px}
  .tabContent[hidden]{display:none!important}
  .imageGrid{display:grid;gap:10px;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));margin-top:12px}
  .imageCard{border:1px solid var(--border,#e6e6e6);border-radius:12px;background:var(--card,#f6f7f9);padding:8px;display:flex;flex-direction:column;gap:6px}
  .imageCard img{width:100%;height:140px;object-fit:cover;border-radius:8px;background:#000}
  .imageCard span{font-size:.85rem;font-weight:600}
</style>
<script>
  window.SONG_DATA_OVERRIDE = {
    slug: "tout-le-monde-sur-le-pont",
    title: "tout le monde sur le pont",
    audio: "media/Tout le monde sur le pont 23nov.mp3",
    parts: [
      { id: "id", label: "label", start: 0, end: 8, images: ["media/tout le monde sur le pont.png"], text: "text" },
      { id: "id", label: "label", start: 8, end: 16, images: ["media/tout le monde sur le pont.png"], text: "text" }
    ]
  };
</script>
</head>
<body id="app" data-theme="">
<header>
  <div class="bar" id="hdr">
    <a class="iconbtn" href="index.html">‚Üê Morceaux</a>
    <div class="title" id="songTitle">Morceau</div>
    <span class="pill">v0.5</span>
    <div class="spacer"></div>
    <button id="themeBtn" class="iconbtn">üåì Th√®me</button>
    <button id="changelogBtn" class="iconbtn">üìù Changelog</button>
  </div>
</header>

<div class="tabNav" role="tablist" aria-label="Sections de la page">
  <button class="tabBtn active" data-tab-btn="principal" role="tab" aria-selected="true" aria-controls="tab-principal">Principal (tout)</button>
  <button class="tabBtn" data-tab-btn="audio" role="tab" aria-selected="false" aria-controls="tab-audio" tabindex="-1">Audio & partitions</button>
  <button class="tabBtn" data-tab-btn="lives" role="tab" aria-selected="false" aria-controls="tab-lives" tabindex="-1">Fichiers lives</button>
  <button class="tabBtn" data-tab-btn="instruments" role="tab" aria-selected="false" aria-controls="tab-instruments" tabindex="-1">Instruments individuels</button>
  <button class="tabBtn" data-tab-btn="notes" role="tab" aria-selected="false" aria-controls="tab-notes" tabindex="-1">Notes</button>
  <button class="tabBtn" data-tab-btn="images" role="tab" aria-selected="false" aria-controls="tab-images" tabindex="-1">Images</button>
  <button class="tabBtn" data-tab-btn="autres" role="tab" aria-selected="false" aria-controls="tab-autres" tabindex="-1">Autres</button>
</div>

<main>
  <section class="tabContent" data-tabs="principal audio">
    <div class="playerSticky">
      <section class="playerCard" aria-labelledby="fullTrackTitle">
        <h2 id="fullTrackTitle">√âcoutez le morceau en entier</h2>
        <audio id="player" controls preload="metadata">
          <source id="audioSrc" src="" />
          Votre navigateur ne supporte pas la balise audio.
        </audio>
        <div id="audioDebug" class="audioDebug"></div>
      </section>
    </div>
  </section>

  <section class="tabContent" id="tab-audio" data-tabs="principal audio">
    <p class="note">
      Touchez ‚ñ∂ ou le titre d‚Äôune section pour y sauter. Touchez une image pour l‚Äôouvrir en plein √©cran.
    </p>

    <section aria-labelledby="partsTitle">
      <h2 id="partsTitle" class="sr-only">Sections (partitions)</h2>
      <div id="sections" class="sections"></div>
    </section>
  </section>

  <section class="tabContent" id="tab-lives" data-tabs="principal lives">
    <h3>Extras</h3>
    <div class="imageGrid" style="margin-top:8px;">
      <div class="imageCard">
        <a href="media/Tout le monde sur le pont 23nov.mp3" download>
          <img src="media/Tout le monde sur le pont 23nov.jpg" alt="Tout le monde sur le pont - audio" loading="lazy">
        </a>
        <span>Tout le monde sur le pont - audio</span>
      </div>
      <div class="imageCard">
        <a href="media/Tout le monde sur le pont 23nov.pdf" download>
          <img src="media/Tout le monde sur le pont 23nov.jpg" alt="Tout le monde sur le pont - partition" loading="lazy">
        </a>
        <span>Tout le monde sur le pont - partition</span>
      </div>
    </div>
  </section>

  <section class="tabContent" id="tab-instruments" data-tabs="principal instruments">
    <section id="instrExtras" style="max-width:980px;margin:18px auto;padding:0 16px;">
      <h3>Instruments individuels</h3>
      <p class="note">Illustrations sonores des parties solo pour les r√©piniques, snaires, agogo, tambourim et repinique.</p>
      <div style="display:grid;gap:10px;grid-template-columns:1fr;">
        <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
          <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Surdo solo &mdash; TLMSPont-2</div>
          <audio id="instr-surdo" controls preload="metadata" style="width:100%;">
            <source src="media/TLMSLPont test q 202511141524 TLMSPont-2 surdo.mp3" type="audio/mpeg" />
            Votre navigateur ne supporte pas la balise audio.
          </audio>
          <div style="display:flex;gap:8px;align-items:center;">
            <button class="extra-skip" data-target="instr-surdo" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
            <button class="extra-skip" data-target="instr-surdo" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
          </div>
        </article>
        <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
          <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Snare solo &mdash; TLMSPont-3</div>
          <audio id="instr-snare" controls preload="metadata" style="width:100%;">
            <source src="media/TLMSLPont test q 202511141524 TLMSPont-3 snare.mp3" type="audio/mpeg" />
            Votre navigateur ne supporte pas la balise audio.
          </audio>
          <div style="display:flex;gap:8px;align-items:center;">
            <button class="extra-skip" data-target="instr-snare" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
            <button class="extra-skip" data-target="instr-snare" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
          </div>
        </article>
        <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
          <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Agogo solo &mdash; TLMSPont-4</div>
          <audio id="instr-agogo" controls preload="metadata" style="width:100%;">
            <source src="media/TLMSLPont test q 202511141524 TLMSPont-4 agogo.mp3" type="audio/mpeg" />
            Votre navigateur ne supporte pas la balise audio.
          </audio>
          <div style="display:flex;gap:8px;align-items:center;">
            <button class="extra-skip" data-target="instr-agogo" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
            <button class="extra-skip" data-target="instr-agogo" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
          </div>
        </article>
        <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
          <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Tambourim solo &mdash; TLMSPont-5</div>
          <audio id="instr-tambourim" controls preload="metadata" style="width:100%;">
            <source src="media/TLMSLPont test q 202511141524 TLMSPont-5 tambourim ca va tres vite et encore plus vite.mp3" type="audio/mpeg" />
            Votre navigateur ne supporte pas la balise audio.
          </audio>
          <div style="display:flex;gap:8px;align-items:center;">
            <button class="extra-skip" data-target="instr-tambourim" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
            <button class="extra-skip" data-target="instr-tambourim" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
          </div>
        </article>
        <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
          <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Repinique solo &mdash; TLMSPont-6</div>
          <audio id="instr-repinique" controls preload="metadata" style="width:100%;">
            <source src="media/TLMSLPont test q 202511141524 TLMSPont-6 repinique ready to samba ok.mp3" type="audio/mpeg" />
            Votre navigateur ne supporte pas la balise audio.
          </audio>
          <div style="display:flex;gap:8px;align-items:center;">
            <button class="extra-skip" data-target="instr-repinique" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
            <button class="extra-skip" data-target="instr-repinique" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
          </div>
        </article>
        <article style="border:1px solid #e6e6e6;background:var(--card);padding:6px;border-radius:8px;display:flex;flex-direction:column;gap:6px;">
          <div style="color:var(--fg);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">ts instruments &mdash; TLMSPont-tt</div>
          <audio id="instr-repinique" controls preload="metadata" style="width:100%;">
            <source src="media/TLMSLPont test q 202511141524 ts instruments .mp3" type="audio/mpeg" />
            Votre navigateur ne supporte pas la balise audio.
          </audio>
          <div style="display:flex;gap:8px;align-items:center;">
            <button class="extra-skip" data-target="instr-repinique" data-offset="-10" aria-label="Reculer 10 secondes">-10s</button>
            <button class="extra-skip" data-target="instr-repinique" data-offset="10" aria-label="Avancer 10 secondes">+10s</button>
          </div>
        </article>
      </div>
    </section>
  </section>

  <section class="tabContent" id="tab-notes" data-tabs="principal notes">
    <h3>Notes rapides</h3>
    <textarea style="width:100%;border:1px solid var(--border,#e6e6e6);border-radius:12px;padding:12px;font:inherit;line-height:1.5;white-space:pre-wrap;" rows="15">
2025-11-27-Thu
Maintenant les R√©piniques et les tambourines font le m√™me rythme
- √áa va tr√®s vite et encore plus vite 
- Ready to samba OK 
-> quand le morceau est plut√¥t lent on fait "
  √ßa va tr√®s vite et encore plus vite"  (parce que c'est plus simple √† faire)
-> Quand le morceau commence √† acc√©l√©rer et et qu'il serait compliqu√© de faire le rythme √ßa va tr√®s vite et encore plus vite on passe √† 
  "ready to samba OK!"
    </textarea>
  </section>  

  <section class="tabContent" id="tab-images" data-tabs="principal images">
    <h3>Images du morceau</h3>
    <div id="imagesGallery" class="imageGrid"></div>
  </section>
</main>

<!-- Visionneuse plein √©cran -->
<div id="fsOverlay" class="fsOverlay" aria-hidden="true">
  <div class="fsInner" id="fsInner">
    <button id="fsClose" class="fsClose" type="button">‚úï Fermer</button>
    <div class="fsImageWrap" id="fsImageWrap">
      <img id="fsImage" src="" alt="Partition en plein √©cran">
    </div>
    <div class="fsMeta">
      <div id="fsLabel" class="fsLabel"></div>
      <div id="fsTime" class="fsTime"></div>
      <div class="fsNavRow">
        <button id="fsPrev" class="fsNavBtn left" type="button"></button>
        <button id="fsNext" class="fsNavBtn right" type="button"></button>
      </div>
      <div class="fsControlsRow">
        <button id="fsPlay" class="fsPlayBtn" type="button">‚ñ∂ Lire √† partir d‚Äôici</button>
        <button id="fsZoom" class="fsZoomBtn" type="button">üîç Zoom</button>
      </div>
    </div>
  </div>
</div>

<section id="changelog" class="changelog tabContent" data-tabs="principal autres">
  <h4>Changelog</h4>
  <ul class="small">
    <li><strong>v0.5</strong> - Pages morceaux en HTML statique (plus de JSON), correction de certains noms de m?dias, ajout d''une playlist vid?o YouTube et de tests pour les tableaux.</li>
    <li><strong>v0.4.4</strong> - Zoom clair (scale) avec d?filement, lecteur ? nouveau en haut (sticky), texte du lecteur masqu? en plein ?cran.</li>
    <li><strong>v0.4.3</strong> - corrections image plein ?cran & espacement.</li>
    <li><strong>v0.4.2</strong> - visionneuse plein ?cran initiale.</li>
  </ul>
</section>

<script src="song.js"></script>
<script>
  (function(){
    const TAB_KEY='tlmp.tab.v1';
    const buttons=[...document.querySelectorAll('[data-tab-btn]')];
    const sections=[...document.querySelectorAll('[data-tabs]')];
    function activate(name){
      buttons.forEach(btn=>{
        const active=btn.dataset.tabBtn===name;
        btn.classList.toggle('active',active);
        btn.setAttribute('aria-selected',active?'true':'false');
        btn.setAttribute('tabindex',active?'0':'-1');
      });
      sections.forEach(section=>{
        const list=(section.dataset.tabs||'').split(/\s+/);
        section.hidden=!list.includes(name);
      });
      try{localStorage.setItem(TAB_KEY,name);}catch{}
    }
    buttons.forEach(btn=>{
      btn.addEventListener('click',()=>activate(btn.dataset.tabBtn));
      btn.addEventListener('keydown',e=>{
        if(e.key!=='ArrowLeft'&&e.key!=='ArrowRight') return;
        e.preventDefault();
        const dir=e.key==='ArrowRight'?1:-1;
        const idx=buttons.indexOf(btn);
        const next=buttons[(idx+dir+buttons.length)%buttons.length];
        next.focus();
        activate(next.dataset.tabBtn);
      });
    });
    activate(localStorage.getItem(TAB_KEY)||'principal');
  })();

  (function buildGallery(){
    const gallery=document.getElementById('imagesGallery');
    if(!gallery) return;
    const data=(window.SONG_DATA_OVERRIDE&&Array.isArray(window.SONG_DATA_OVERRIDE.parts))?window.SONG_DATA_OVERRIDE.parts:[];
    const seen=new Set();
    const items=[];
    data.forEach(part=>{
      (part.images||[]).forEach(src=>{
        if(!src||seen.has(src)) return;
        seen.add(src);
        items.push({src,label:part.label||'Image'});
      });
    });
    if(!items.length){
      gallery.innerHTML='<p class="note">Aucune image disponible.</p>';
      return;
    }
    gallery.innerHTML=items.map(item=>`
      <article class="imageCard">
        <img src="${item.src}" alt="${item.label}">
        <span>${item.label}</span>
      </article>
    `).join('');
  })();
</script>
</body>
</html>



